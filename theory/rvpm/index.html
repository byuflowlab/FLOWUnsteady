<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Reformulated VPM Â· FLOWUnsteady</title><script async src="https://www.googletagmanager.com/gtag/js?id=G-B7CBF7WC7L"></script><script>  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-B7CBF7WC7L', {'page_path': location.pathname + location.search + location.hash});
</script><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="FLOWUnsteady logo"/></a><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Intro</a></li><li><a class="tocitem" href="../../installation/general/">Installation</a></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">Tutorials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-4-1" type="checkbox"/><label class="tocitem" for="menuitem-4-1"><span class="docs-label">Simple Wing</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../examples/wing-4p2aoa/">Basics</a></li><li><a class="tocitem" href="../../examples/wing-aoasweep/">AOA Sweep</a></li></ul></li><li><a class="tocitem" href="../../examples/tetheredwing/">Tethered Wing</a></li><li><a class="tocitem" href="../../examples/heavingwing/">Heaving Wing</a></li><li><input class="collapse-toggle" id="menuitem-4-4" type="checkbox"/><label class="tocitem" for="menuitem-4-4"><span class="docs-label">Propeller</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../examples/propeller-J040/">Basics</a></li><li><a class="tocitem" href="../../examples/propeller-jsweep/"><span>$J$</span> Sweep</a></li><li><a class="tocitem" href="../../examples/propeller-quasisteady/">Quasi-Steady Solver</a></li><li><a class="tocitem" href="../../examples/propeller-incidence/">Incidence Sweep</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-5" type="checkbox"/><label class="tocitem" for="menuitem-4-5"><span class="docs-label">Rotor in Hover</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../examples/rotorhover-aero/">Variable Fidelity</a></li><li><a class="tocitem" href="../../examples/rotorhover-fdom/">Fluid Domain</a></li><li><a class="tocitem" href="../../examples/rotorhover-acoustics/">Aeroacoustics</a></li><li><a class="tocitem" href="../../examples/rotorhover-quasisteady/">Quasi-Steady Solver</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-6" type="checkbox"/><label class="tocitem" for="menuitem-4-6"><span class="docs-label">Blown Wing</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../examples/blownwing-aero/">Wing-on-Prop Interactions</a></li><li><a class="tocitem" href="../../examples/blownwing-asm/">Actuator Surface Model</a></li><li><a class="tocitem" href="../../examples/prowim-aero/">Prop-on-Wing Interactions</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-7" type="checkbox"/><label class="tocitem" for="menuitem-4-7"><span class="docs-label">eVTOL Aircraft</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../examples/vahana-vehicle/">Vehicle Definition</a></li><li><a class="tocitem" href="../../examples/vahana-maneuver/">Maneuver Definition</a></li><li><a class="tocitem" href="../../examples/vahana-monitor/">Monitors Definitions</a></li><li><a class="tocitem" href="../../examples/vahana-run/">Run Simulation</a></li></ul></li><li><a class="tocitem" href="../../examples/openvsp-aircraft/">OpenVSP Geometry</a></li></ul></li><li><a class="tocitem" href="../../visualization/">Visualization</a></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox" checked/><label class="tocitem" for="menuitem-6"><span class="docs-label">Theory</span><i class="docs-chevron"></i></label><ul class="collapsed"><li class="is-active"><a class="tocitem" href>Reformulated VPM</a><ul class="internal"><li><a class="tocitem" href="#Vorticity-Navier-Stokes"><span>Vorticity Navier-Stokes</span></a></li><li><a class="tocitem" href="#particlediscretization"><span>Particle Discretization</span></a></li><li><a class="tocitem" href="#Governing-Equations"><span>Governing Equations</span></a></li><li><a class="tocitem" href="#sfsmodel"><span>Turbulence Model</span></a></li><li><a class="tocitem" href="#Immersed-Vorticity"><span>Immersed Vorticity</span></a></li><li><a class="tocitem" href="#Other-Schemes"><span>Other Schemes</span></a></li></ul></li><li><a class="tocitem" href="../convergence/">Convergence</a></li><li><a class="tocitem" href="../validation/">Validation</a></li><li><a class="tocitem" href="../publications/">Publications</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-7" type="checkbox"/><label class="tocitem" for="menuitem-7"><span class="docs-label">API Guide</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-7-1" type="checkbox"/><label class="tocitem" for="menuitem-7-1"><span class="docs-label">(1) Vehicle Definition</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../api/flowunsteady-vehicle-types/">Vehicle types</a></li><li><a class="tocitem" href="../../api/flowunsteady-vehicle-components/">Generating components</a></li><li><a class="tocitem" href="../../api/flowunsteady-vehicle-asm/">Actuator surface model</a></li><li><a class="tocitem" href="../../api/flowunsteady-openvsp/">OpenVSP geometry</a></li></ul></li><li><a class="tocitem" href="../../api/flowunsteady-maneuver/">(2) Maneuver Definition</a></li><li><a class="tocitem" href="../../api/flowunsteady-simulation/">(3) Simulation Definition</a></li><li><a class="tocitem" href="../../api/flowunsteady-monitor/">(4) Monitors Definitions</a></li><li><a class="tocitem" href="../../api/flowunsteady-run/">(5) Run Simulation</a></li><li><input class="collapse-toggle" id="menuitem-7-6" type="checkbox"/><label class="tocitem" for="menuitem-7-6"><span class="docs-label">(6) Viz and Postprocessing</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../api/flowunsteady-postprocessing-fdom/">Fluid Domain</a></li><li><a class="tocitem" href="../../api/flowunsteady-postprocessing-noise/">Aeroacoustic Noise</a></li><li><a class="tocitem" href="../../api/flowunsteady-postprocessing-misc/">Miscellaneous</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-7-7" type="checkbox"/><label class="tocitem" for="menuitem-7-7"><span class="docs-label">Extras</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-7-7-1" type="checkbox"/><label class="tocitem" for="menuitem-7-7-1"><span class="docs-label">FLOWVPM</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../api/flowvpm-particle/">Particle Field</a></li><li><a class="tocitem" href="../../api/flowvpm-uj/">UJ Scheme</a></li><li><a class="tocitem" href="../../api/flowvpm-viscous/">Viscous Scheme</a></li><li><a class="tocitem" href="../../api/flowvpm-relaxation/">Relaxation Scheme</a></li><li><a class="tocitem" href="../../api/flowvpm-sfs/">SFS Scheme</a></li><li><a class="tocitem" href="../../api/flowvpm-time/">Time Integration</a></li><li><a class="tocitem" href="../../api/flowvpm-utils/">Utilities</a></li></ul></li></ul></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Theory</a></li><li class="is-active"><a href>Reformulated VPM</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Reformulated VPM</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/byuflowlab/FLOWUnsteady/blob/master/docs/src/theory/rvpm.md" title="Edit on GitHub"><span class="docs-icon fab">ï</span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Reformulated-VPM"><a class="docs-heading-anchor" href="#Reformulated-VPM">Reformulated VPM</a><a id="Reformulated-VPM-1"></a><a class="docs-heading-anchor-permalink" href="#Reformulated-VPM" title="Permalink"></a></h1><p>The following is an excerpt from  E. J. Alvarez &amp; A. Ning (2022), <em>&quot;Meshless Large Eddy Simulation of Rotor-Wing Interactions Through the Reformulated Vortex Particle Method,&quot;</em> (in review).</p><h2 id="Vorticity-Navier-Stokes"><a class="docs-heading-anchor" href="#Vorticity-Navier-Stokes">Vorticity Navier-Stokes</a><a id="Vorticity-Navier-Stokes-1"></a><a class="docs-heading-anchor-permalink" href="#Vorticity-Navier-Stokes" title="Permalink"></a></h2><p>In recent work<sup class="footnote-reference"><a id="citeref-1" href="#footnote-1">[1]</a></sup><sup class="footnote-reference"><a id="citeref-2" href="#footnote-2">[2]</a></sup>, a new formulation of the vortex particle method (VPM) has been derived from the LES-filtered Navier-Stokes equations. The new method, referred to as the reformulated VPM or rVPM, is an LES that is both numerically stable and meshless, and is able to accurately resolve mean and fluctuating large-scale features of turbulent flow with minimal computational effort. Hereby we concisely summarize the governing equations of the reformulated VPM, and the reader is referred to Ref.<sup class="footnote-reference"><a id="citeref-1" href="#footnote-1">[1]</a></sup> and the doctoral dissertation<sup class="footnote-reference"><a id="citeref-2" href="#footnote-2">[2]</a></sup> accompanying this work for a detailed derivation of the method.</p><p>The reformulated VPM uses a Lagrangian scheme to solve the vorticity form of the LES-filtered Navier-Stokes equations</p><p class="math-container">\[\begin{align}
        \frac{\partial \overline{ \omega_i }}{\partial t}
        + \overline{ u_j } \frac{\partial \overline{ \omega_i }}{\partial x_j}
    &amp; =
        \overline{ \omega_j } \frac{\partial \overline{ u_i }}{\partial x_j}
    +
        \nu \nabla^2 \overline{ \omega_i } -
        \frac{\partial T&#39;_{ij}}{\partial x_j} +
        \frac{\partial T_{ij}}{\partial x_j}
,\end{align}\]</p><p>where the bar denotes the filter operator,<sup class="footnote-reference"><a id="citeref-a" href="#footnote-a">[a]</a></sup> and <span>$T_{ij} \equiv \overline{ u_i \omega_j } - \overline{ u_i } \, \overline{ \omega_j }$</span> is the subfilter-scale (SFS) vorticity stress capturing the interactions between large-scale dynamics and SFS dynamics. The term <span>$\frac{\partial T&#39;_{ij}}{\partial x_j}$</span> represents the SFS contributions arising from the advective term (vorticity advection), while <span>$\frac{\partial T_{ij}}{\partial x_j}$</span> represents the contributions arising from vortex stretching. For simplicity, Eq. (1) is written in vector notation as</p><p class="math-container">\[\begin{align}
    \frac{\text{d} }{\text{d} t} \overline{ \boldsymbol\omega }
    = \left( \overline{ \boldsymbol\omega } \cdot \nabla \right) \overline{ \mathbf{u} } +
    \nu \nabla^2 \overline{ \boldsymbol\omega }
    - \mathbf{E}_\mathrm{adv} - \mathbf{E}_\mathrm{str}
,\end{align}\]</p><p>where <span>$\left( \mathbf{E}_\mathrm{adv} \right)_i \equiv \frac{\partial T&#39;_{ij}}{\partial x_j}$</span> is the SFS vorticity advection, <span>$\left( \mathbf{E}_\mathrm{str} \right)_i \equiv - \frac{\partial T_{ij}}{\partial x_j}$</span> is the SFS vortex stretching, and the <span>$\frac{\text{d} }{\text{d} t}$</span> operator is the linearized version of the filtered material derivative, <span>$\frac{\text{d} }{\text{d} t} () \equiv \frac{\partial }{\partial t}() + {(\overline{ {\bf u} } \cdot \nabla)()}$</span>. Notice that casting the Navier-Stokes equation into this vorticity form gets rid of all dependance on pressure. Furthermore, this equation depends on <span>$\boldsymbol{\omega}$</span> alone since <span>$\bf{u}$</span> can be calculated directly from <span>$\boldsymbol{\omega} = \nabla \times \bf{u}$</span> through the Biot-Savart law.</p><h2 id="particlediscretization"><a class="docs-heading-anchor" href="#particlediscretization">Particle Discretization</a><a id="particlediscretization-1"></a><a class="docs-heading-anchor-permalink" href="#particlediscretization" title="Permalink"></a></h2><p>The material derivative in Eq. (2) and the material-conservative nature of the vorticity makes the <span>$\boldsymbol{\omega}$</span> field especially well fit for a Lagrangian description. The unfiltered <span>$\boldsymbol{\omega}$</span> field is discretized with singular vortex particles of positions <span>${\bf x}_p$</span> and coefficients <span>$\boldsymbol{\Gamma}_p$</span> (called <em>vortex strength</em>), approximating <span>$\boldsymbol{\omega}$</span> as</p><p class="math-container">\[\begin{align} % \label{eq:particle:dirac}
    \boldsymbol{\omega}({\bf x},t) \approx \sum
        \limits_p \boldsymbol{\Gamma}_p (t)
            \delta  ({\bf x} - {\bf x}_p(t))
,\end{align}\]</p><p>where <span>$\delta$</span> is the Dirac delta. Applying the filter operator,</p><p class="math-container">\[\begin{align*}
        \overline{ \boldsymbol{\omega} } \left( \mathbf{x} \right)
    &amp; =
        \int\limits_{-\infty}^\infty
            \boldsymbol{\omega}\left( \mathbf{y} \right)
            \zeta_\sigma(\mathbf{x}-\mathbf{y})
        \,\mathrm{d}\mathbf{y}
    % \\ &amp;
    \approx
        \int\limits_{-\infty}^\infty
            \left(
                \sum\limits_p
                    \boldsymbol{\Gamma}_p
                    \delta ({\textbf y} - {\textbf x}_p)
            \right)
            \zeta_\sigma(\mathbf{x}-\mathbf{y})
        \,\mathrm{d}\mathbf{y}
,\end{align*}\]</p><p>the Dirac delta collapses the integral, obtaining an approximation of the filtered vorticity field as</p><p class="math-container">\[\begin{align} % \label{eq:particle:blob}
        \overline{\boldsymbol\omega}\left( \mathbf{x},\,t \right)
    &amp; \approx
        \sum\limits_p
            \boldsymbol{\Gamma}_p (t)
            \zeta_{\sigma_p}(\mathbf{x}-\mathbf{x}_p(t))
,\end{align}\]</p><p>where <span>$\zeta_{\sigma}(\mathbf{x}) \equiv \frac{1}{\sigma^3} \zeta \left(\frac{\Vert \mathbf{x} \Vert}{\sigma} \right)$</span> is the filter kernel of width <span>$\sigma$</span> and radial basis <span>$\zeta$</span>. As seen in Eq. (4), the filter operator has the effect of spreading the vortex strength <span>$\boldsymbol{\Gamma}_p$</span> in space, regularizing the singularity originally introduced by the Dirac delta. Thus, the filter kernel takes the role of a basis function that is used to discretize <span>$\overline{\boldsymbol\omega}$</span> through particles. We let the filter width <span>$\sigma$</span> (here on called <em>smoothing radius</em> or <em>core size</em>) change in time and space according to the evolution of each individual particle. The particle field constructs a continuous vorticity field through radial basis functions as given by Eq. (4), and also a continuous velocity field by inverting the relation <span>${\overline{\boldsymbol\omega} = \nabla \times \overline{\mathbf{u}}}$</span> as</p><p class="math-container">\[\begin{align} % \label{eq:U:reg}
        \overline{ \mathbf{u} }\left( \mathbf{x} \right)
    =
        - \frac{1}{4\pi}\sum\limits_p g_{\sigma_p}\left( \mathbf{x}-\mathbf{x}_p \right)
            \frac{\mathbf{x}-\mathbf{x}_p}{\Vert\mathbf{x}-\mathbf{x}_p\Vert^3}
            \times
            \boldsymbol\Gamma_p
,\end{align}\]</p><p>where <span>$g_{\sigma}$</span> is the regularizing function<sup class="footnote-reference"><a id="citeref-3" href="#footnote-3">[3]</a></sup> associated with the filter kernel <span>$\zeta_\sigma$</span>. Hence, all fluid propertiesâlike <span>$\overline{\mathbf{u}}$</span> and its spatial derivativesâare continuous and can be computed analytically.</p><h2 id="Governing-Equations"><a class="docs-heading-anchor" href="#Governing-Equations">Governing Equations</a><a id="Governing-Equations-1"></a><a class="docs-heading-anchor-permalink" href="#Governing-Equations" title="Permalink"></a></h2><p>Similar to the process that led from Eq. (3) to Eq. (4), we use singular particles to discretize the LES-filtered vorticity equation given in Eq. (2), and arrive to the governing equations of the reformulated VPM:</p><p class="math-container">\[\begin{align}
    % \label{eq:rvpm:ge:dxdt}
    % \bullet \quad
    &amp;
        \frac{\text{d}}{\text{d}t}{\bf x}_p
        =
        \overline{\mathbf{u}}({\bf x}_p)
\end{align}\]</p><p class="math-container">\[\begin{align}
    % \\ % \label{eq:rvpm:ge:dGammadt}
    \begin{split}
        % \bullet \quad
        &amp; \frac{\mathrm{d} }{\mathrm{d} t} \boldsymbol{\Gamma}_p
        =
            \left(
                \boldsymbol{\Gamma}_p \cdot \nabla
            \right)
            \overline{\mathbf{u}} ({\bf x}_p)
            -
            \frac{g + f}{\frac{1}{3} + f}
            \left\{
                \left[
                    \left(
                            \boldsymbol{\Gamma}_p  \cdot \nabla
                        \right)
                        \overline{\mathbf{u}} {\small ({\bf x}_p)}
                \right]
                \cdot \hat{\boldsymbol{\Gamma}}_p
            \right\} \hat{\boldsymbol{\Gamma}}_p
        \\
        &amp; \qquad \qquad \,\,\,
        \qquad \qquad \quad \,\,
            - \frac{C_d}{\zeta_{\sigma_p} ({\bf 0})}
            \left[
                \mathbf{E}_\mathrm{str} ({\bf x}_p)
                -
                \frac{f}{\frac{1}{3} + f}
                \left(
                    \mathbf{E}_\mathrm{str} ({\bf x}_p) \cdot \hat{\boldsymbol{\Gamma}}_p
                \right) \hat{\boldsymbol{\Gamma}}_p
            \right]
    \end{split}
\end{align}\]</p><p class="math-container">\[\begin{align}
    % \\ % \label{eq:rvpm:ge:dsigmadt}
    % \bullet \quad
    &amp;
        \frac{\mathrm{d} }{\mathrm{d} t} \sigma_p
        =
        - \left(
            \frac{g + f}{1 + 3f}
        \right)
        \frac{\sigma_p}{\Vert \boldsymbol{\Gamma}_p \Vert}
            \left[
                \left(
                        \boldsymbol{\Gamma}_p  \cdot \nabla
                    \right)
                    \overline{\mathbf{u}} {\small ({\bf x}_p)}
            \right]
            \cdot \hat{\boldsymbol{\Gamma}}_p
        +
        \left(
            \frac{f}{1 + 3f}
        \right)
        \frac{\sigma_p}{\Vert \boldsymbol{\Gamma}_p \Vert}
        \frac{C_d}{\zeta_{\sigma_p} ({\bf 0})}
        \mathbf{E}_\mathrm{str} ({\bf x}_p) \cdot \hat{\boldsymbol{\Gamma}}_p
\end{align}\]</p><p class="math-container">\[\begin{align}
    % \\ % \label{eq:rvpm:ge:viscous}
    % \bullet \quad
    &amp;
        \left(
            \frac{\text{d} }{\text{d} t} \overline{ \boldsymbol\omega }
        \right)_\mathrm{viscous}
        =
        \nu \nabla^2 \overline{ \boldsymbol\omega }
\end{align}\]</p><p>where Eq. (6) resolves vorticity advection by convecting the particles, Eq. (7) governs the evolution of vortex strength, and Eq. (8) governs the evolution of particle size. Eq. (7) in conjunction with Eqs. (6) and (8) resolve the inviscid part of the LES-filtered vorticity Navier-Stokes equation, while the viscous part in Eq. (9) can be resolved through any of the schemes previously proposed in the literature (<em>e.g.</em>, vortex redistribution method, particle strength exchange, or core spreading).</p><p>The main headway of the reformulated VPM over the classic VPM is that rVPM uses the particle size, or <span>$\frac{\mathrm{d} }{\mathrm{d} t} \sigma_p$</span>, as an extra degree of freedom to reinforce conservation laws. As shown in References <sup class="footnote-reference"><a id="citeref-1" href="#footnote-1">[1]</a></sup> and <sup class="footnote-reference"><a id="citeref-2" href="#footnote-2">[2]</a></sup>, momentum and mass conservation leads to <span>$f = 0$</span> and <span>$g = \frac{1}{5}$</span>, and Eqs. (7) and (8) become</p><p class="math-container">\[\begin{align*}
    % \bullet \quad
    &amp; \frac{\mathrm{d} }{\mathrm{d} t} \boldsymbol{\Gamma}_p
    =
        \left(
            \boldsymbol{\Gamma}_p \cdot \nabla
        \right)
        \overline{ \mathbf{u} } (\mathbf{x}_p)
        -
        \frac{3}{5}
        \left\{
            \left[
                \left(
                        \boldsymbol{\Gamma}_p  \cdot \nabla
                    \right)
                    \overline{ \mathbf{u} } {\small (\mathbf{x}_p)}
            \right]
            \cdot \hat{\boldsymbol{\Gamma}}_p
        \right\} \hat{\boldsymbol{\Gamma}}_p
        - \frac{C_d}{\zeta_{\sigma_p} (\mathbf{0})}
            \mathbf{E}_\mathrm{str} (\mathbf{x}_p)
    \\
    % \bullet \quad
    &amp;
        \frac{\mathrm{d} }{\mathrm{d} t} \sigma_p
        =
        -
        \frac{1}{5}
        \frac{\sigma_p}{\Vert \boldsymbol{\Gamma}_p \Vert}
            \left[
                \left(
                        \boldsymbol{\Gamma}_p  \cdot \nabla
                    \right)
                    \overline{ \mathbf{u} } {\small (\mathbf{x}_p)}
            \right]
            \cdot \hat{\boldsymbol{\Gamma}}_p
,\end{align*}\]</p><p>which is the formulation referred to as the &quot;reformulated VPM.&quot; Notice that when <span>$f = g = 0$</span> and <span>$\mathbf{E}_\mathrm{str}$</span> is neglected, Eqs. (7) and (8) collapse back to the classic VPM equations, making these equations a generalization of the classic method. In Reference <sup class="footnote-reference"><a id="citeref-2" href="#footnote-2">[2]</a></sup> is shown that the classic VPM turns out to violate both conservation of momentum and mass when it assumes <span>$\frac{\mathrm{d} }{\mathrm{d} t} \sigma_p = 0$</span>, which explains the tendency of the classic VPM to be numerically unstable. Furthermore, notice that the rVPM equations do not require more computation than the classic VPM: when SFS effects are neglected (<span>$\mathbf{E}_\mathrm{str}=0$</span>), both <span>$\frac{\mathrm{d} \sigma_p }{\mathrm{d}t}$</span> and <span>$\frac{\mathrm{d} \boldsymbol{\Gamma}_p}{\mathrm{d} t}$</span> are calculated directly and solely from vortex stretching, <span>$\left( \boldsymbol{\Gamma}_p \cdot \nabla  \right) \overline{\mathbf{u}} ({\bf x}_p)$</span>.</p><blockquote><p>For an in-depth derivation of the rVPM governing equations, see Chapters 1 and 2 in <a href="https://scholarsarchive.byu.edu/etd/9589">Alvarez&#39; Dissertation</a>.<sup class="footnote-reference"><a id="citeref-2" href="#footnote-2">[2]</a></sup></p></blockquote><h2 id="sfsmodel"><a class="docs-heading-anchor" href="#sfsmodel">Turbulence Model</a><a id="sfsmodel-1"></a><a class="docs-heading-anchor-permalink" href="#sfsmodel" title="Permalink"></a></h2><p>Turning our attention back to the SFS stress tensor <span>$T_{ij}$</span>, the accuracy of LES hinges on the modeling of this tensor. Its divergence represents the rate at which enstrophyâa measure of rotational kinetic energyâis transferred from resolved scales to subfilter scales (diffusion) and from subfilter scales to resolved scales (backscatter). In vortex methods, the most common SFS models use variants of the Smagorinsky eddy-viscosity model formulated for the vorticity stress.<sup class="footnote-reference"><a id="citeref-4" href="#footnote-4">[4]</a></sup><sup class="footnote-reference"><a id="citeref-5" href="#footnote-5">[5]</a></sup> However, these models are developed on the basis of homogeneous isotropic turbulence, which makes them overly diffusive in simulations with coherent vortical structures. In Reference <sup class="footnote-reference"><a id="citeref-1" href="#footnote-1">[1]</a></sup>, the following anisotropic model of SFS vortex stretching is proposed:</p><p class="math-container">\[\begin{align*} % \label{eq:Estr}
        \mathbf{E}_\mathrm{str} \left( \mathbf{x} \right)
    \approx
        \sum\limits_q
            \zeta_{\sigma}(\mathbf{x}-\mathbf{x}_q)
            \left(
                \boldsymbol{\Gamma}_q \cdot \nabla
            \right)
            \left(
                \overline{\mathbf{u}} \left( \mathbf{x} \right) - \overline{\mathbf{u}} \left( \mathbf{x}_q \right)
            \right)
.\end{align*}\]</p><p>The model coefficient <span>$C_d$</span> is calculated dynamically at the position of every particle as</p><p class="math-container">\[\begin{align*} % \label{eq:Cd:GammaMLave}
        C_d
    =
        \frac{
            \left&lt; \boldsymbol\Gamma_p \cdot \mathbf{L} \right&gt;
        }{
            \left&lt; \boldsymbol\Gamma_p \cdot \mathbf{m} \right&gt;
        }
,\end{align*}\]</p><p>where <span>$\left&lt; \cdot \right&gt;$</span> denotes an integration along Lagrangian trajectories<sup class="footnote-reference"><a id="citeref-6" href="#footnote-6">[6]</a></sup>, and</p><p class="math-container">\[\begin{align*}
    &amp;
        \mathbf{m} =
            \frac{\sigma^3}{\zeta(0)} \frac{\partial \mathbf{E}_\mathrm{str} }{\partial \sigma} (\mathbf{x}_p)
    \\
    &amp;
        \mathbf{L} =
            \frac{3}{\sigma}
            \left( \boldsymbol\Gamma_p \cdot \nabla \right)
            \left(
                \mathbf{u} (\mathbf{x}_p) - \overline{\mathbf{u}} (\mathbf{x}_p)
            \right)
            +
            \left( \boldsymbol\Gamma_p \cdot \nabla \right)
            \frac{\partial \overline{\mathbf{u}} }{\partial \sigma}  (\mathbf{x}_p)
.\end{align*}\]</p><p>This dynamic procedure is based on a simultaneous balance of enstrophy-production and derivatives between true and modeled SFS contributions. Backscatter is controlled by clipping the model coefficient to <span>$C_d=0$</span> whenever the condition <span>$C_d \boldsymbol\Gamma_p \cdot \mathbf{E}_\mathrm{str} (\mathbf{x}_p) \geq 0$</span> is not satisfied. This results in a low-dissipation SFS model that uses vortex stretching as the physical mechanism for turbulence, which is well suited for flows with coherent vortical structures where the predominant cascade mechanism is vortex stretching.</p><blockquote><p>For an in-depth derivation of the SFS model, see Chapter 3 in <a href="https://scholarsarchive.byu.edu/etd/9589">Alvarez&#39; Dissertation</a>.<sup class="footnote-reference"><a id="citeref-2" href="#footnote-2">[2]</a></sup></p></blockquote><h2 id="Immersed-Vorticity"><a class="docs-heading-anchor" href="#Immersed-Vorticity">Immersed Vorticity</a><a id="Immersed-Vorticity-1"></a><a class="docs-heading-anchor-permalink" href="#Immersed-Vorticity" title="Permalink"></a></h2><p>In order to immerse the vorticity of solid boundaries into the LES-filtered Navier-Stokes equations, the filtered vorticity field <span>$\overline{\boldsymbol\omega}(\mathbf{x}, t)$</span> is decomposed into a free-vorticity field <span>$\overline{\boldsymbol\omega}_\mathrm{free}(\mathbf{x}, t)$</span> and a bound-vorticity field <span>$\overline{\boldsymbol\omega}_\mathrm{bound}(\mathbf{x}, t)$</span> as</p><p class="math-container">\[\begin{align*}
        \overline{\boldsymbol\omega}
    =
        \overline{\boldsymbol\omega}_\mathrm{free} + \overline{\boldsymbol\omega}_\mathrm{bound}
.\end{align*}\]</p><p>Both components can be discretized with vortex particles as</p><p class="math-container">\[\begin{align*}
        \overline{\boldsymbol\omega} (\mathbf{x})
    =
        \underbrace{
            \sum\limits_p {\boldsymbol\Gamma}_p \zeta_{\sigma_p} \left( \mathbf{x} - \mathbf{x}_p \right)
        }_{\overline{\boldsymbol\omega}_\mathrm{free}}
        +
        \underbrace{
            \sum\limits_b {\boldsymbol\Gamma}_b \zeta_{\sigma_b} \left( \mathbf{x} - \mathbf{x}_b \right)
        }_{\overline{\boldsymbol\omega}_\mathrm{bound}}
,\end{align*}\]</p><p>where the particles discretizing the free-vorticity field evolve according to the rVPM governing equations, Eqs. (6) through (9), while the ones discretizing the bound-vorticity are embedded on the solid boundaries and their strength is calculated by actuator models derived in <a href="https://scholarsarchive.byu.edu/etd/9589">Alvarez&#39; Dissertation</a>,<sup class="footnote-reference"><a id="citeref-2" href="#footnote-2">[2]</a></sup> Chapter 6. The velocity field is obtained by inverting the relation <span>${\boldsymbol\omega = \nabla \times \mathbf{u}}$</span>, resulting in</p><p class="math-container">\[\begin{align*}
        \overline{ \mathbf{u} }\left( \mathbf{x} \right)
    =
        \underbrace{
            \sum\limits_p g_{\sigma_p}\left( \mathbf{x}-\mathbf{x}_p \right)
                \mathbf{K}\left( \mathbf{x}-\mathbf{x}_p \right)
                \times
                \boldsymbol\Gamma_p
        }_{\overline{\mathbf{u}}_\mathrm{free}}
        +
        \underbrace{
            \sum\limits_b g_{\sigma_b}\left( \mathbf{x}-\mathbf{x}_b \right)
                \mathbf{K}\left( \mathbf{x}-\mathbf{x}_b \right)
                \times
                \boldsymbol\Gamma_b
        }_{\overline{\mathbf{u}}_\mathrm{bound}}
,\end{align*}\]</p><p>which includes the velocity induced by both free and bound vorticity components, and where <span>$\mathbf{K}\left( \mathbf{x} \right) \equiv - \frac{1}{4\pi} \frac{\mathbf{x}}{\Vert\mathbf{x}\Vert^3}$</span>. Thus, the evolution of the free particles is influenced by the vorticity immersed at the solid boundaries, affecting their convection and vortex stretching through the velocity field induced by the bound particles.</p><p>The immersed vorticity not only affects the evolution of existing free vorticity, but it also creates new free vorticity at the boundary through viscous diffusion. In reality, vorticity is created in the boundary layer, it builds up as it travels along the surface, and it is eventually shed off the surface either by the Kutta condition at the trailing edge, flow separation, or other turbulent mechanisms. On a slender body, the vorticity can be assumed to be shed at the trailing edge.</p><p>In most models inside FLOWUnsteady, instead of creating vorticity through the viscous diffusion equation, the immersed vorticity is shed along a prescribed trailing edge. This approach neglects the wake created by flow separation. However, the effects of flow separation on loading (like the drop in lift and increase in pressure drag on a stalled airfoil) can still be captured whenever lookup airfoil tables are used.</p><div class="admonition is-compat"><header class="admonition-header">Recommended</header><div class="admonition-body"><p>For an in-depth discussion of the actuator line and surface models implemented in FLOWUnsteady, see Chapter 6 in <a href="https://scholarsarchive.byu.edu/etd/9589">Alvarez&#39; Dissertation</a>.<sup class="footnote-reference"><a id="citeref-2" href="#footnote-2">[2]</a></sup></p></div></div><h2 id="Other-Schemes"><a class="docs-heading-anchor" href="#Other-Schemes">Other Schemes</a><a id="Other-Schemes-1"></a><a class="docs-heading-anchor-permalink" href="#Other-Schemes" title="Permalink"></a></h2><p>In the default settings of FLOWUnsteady, vortex stretching is resolved with the transposed scheme and the divergence of the vorticity field is treated through the relaxation scheme developed by Pedrizzeti.<sup class="footnote-reference"><a id="citeref-7" href="#footnote-7">[7]</a></sup> The time integration of the governing equations is done through a low-storage third-order Runge-Kutta scheme. A Gaussian kernel is used as the LES filter <span>$\zeta_\sigma$</span> (or VPM radial basis function). Like the classic VPM, the reformulated VPM is spatially second-order accurate in the convective term when a Gaussian basis is used. Viscous diffusion is solved through the core spreading method coupled with the radial basis function interpolation approach for spatial adaptation developed by Barba.<sup class="footnote-reference"><a id="citeref-8" href="#footnote-8">[8]</a></sup> This viscous scheme has second-order spatial convergence, while showing linear convergence when coupled with spatial adaptation. The fast multipole method (FMM) is used for the computation of the regularized Biot-Savart law, approximating the velocity field and vortex stretching through spherical harmonics with computational complexity <span>$\mathcal{O}(N)$</span>, where <span>$N$</span> is the number of particles. The FMM computation of vortex stretching is performed through an efficient complex-step derivative approximation,<sup class="footnote-reference"><a id="citeref-9" href="#footnote-9">[9]</a></sup> implemented in a modified version of the open-source, parallelized code <a href="https://joss.theoj.org/papers/10.21105/joss.03145">ExaFMM</a>. <a href="https://github.com/byuflowlab/FLOWVPM.jl">FLOWVPM</a> and <a href="https://github.com/byuflowlab/FLOWUnsteady">FLOWUnsteady</a> are implemented in <a href="https://julialang.org">the Julia language</a>, which is a modern, high-level, dynamic programming language for high-performance computing.</p><div class="admonition is-compat"><header class="admonition-header">Recommended</header><div class="admonition-body"><p>For an in-depth discussion of the numerical schemes implemented in FLOWUnsteady, see Chapter 4 in <a href="https://scholarsarchive.byu.edu/etd/9589">Alvarez&#39; Dissertation</a>.<sup class="footnote-reference"><a id="citeref-2" href="#footnote-2">[2]</a></sup></p></div></div><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-1"><a class="tag is-link" href="#citeref-1">1</a>E. J. Alvarez &amp; A. Ning (2022), &quot;Reviving the Vortex Particle Method: A Stable Formulation for Meshless Large Eddy Simulation,&quot; <em>(in review)</em>. <a href="https://arxiv.org/pdf/2206.03658.pdf"><strong>[PDF]</strong></a></li><li class="footnote" id="footnote-2"><a class="tag is-link" href="#citeref-2">2</a>E. J. Alvarez (2022), &quot;Reformulated Vortex Particle Method and Meshless Large Eddy Simulation of Multirotor Aircraft,&quot; <em>Doctoral Dissertation, Brigham Young University</em>. <a href="https://www.nas.nasa.gov/pubs/ams/2022/08-09-22.html"><strong>[VIDEO]</strong></a> <a href="https://scholarsarchive.byu.edu/etd/9589/"><strong>[PDF]</strong></a></li><li class="footnote" id="footnote-3"><a class="tag is-link" href="#citeref-3">3</a>Winckelmans, G., and Leonard, A., âContributions to Vortex Particle Methods for the Computation of Three-Dimensional Incompressible Unsteady Flows,â Journal of Computational Physics, Vol. 109, No. 2, 1993.</li><li class="footnote" id="footnote-4"><a class="tag is-link" href="#citeref-4">4</a>Winckelmans, G. S., âSome progress in large-eddy simulation using the 3D vortex particle method,â CTR Annual Research Briefs, , No. 2, 1995, pp. 391â415.</li><li class="footnote" id="footnote-5"><a class="tag is-link" href="#citeref-5">5</a>Mansfield, J. R., Knio, O. M., and Meneveau, C., âA Dynamic LES Scheme for the Vorticity Transport Equation: Formulation and a Priori Tests,â Journal of Computational Physics, Vol. 145, No. 2, 1998, pp. 693â730.</li><li class="footnote" id="footnote-6"><a class="tag is-link" href="#citeref-6">6</a>Meneveau, C., Lund, T. S., and Cabot, W. H., âA Lagrangian dynamic subgrid-scale model of turbulence,â Journal of Fluid Mechanics, Vol. 319, No. -1, 1996, p. 353.</li><li class="footnote" id="footnote-7"><a class="tag is-link" href="#citeref-7">7</a>Pedrizzetti, G., âInsight into singular vortex flows,â Fluid Dynamics Research, Vol. 10, No. 2, 1992, pp. 101â115.</li><li class="footnote" id="footnote-8"><a class="tag is-link" href="#citeref-8">8</a>Barba, L. A., Leonard, A., and Allen, C. B., âAdvances in viscous vortex methods - Meshless spatial adaption based on radial basis function interpolation,â International Journal for Numerical Methods in Fluids, Vol. 47, No. 5, 2005, pp. 387â421. Also, Barba, L. A., âVortex Method for computing high-Reynolds number Flows: Increased accuracy with a fully mesh-less formulation,â California Institute of Technology, Vol. 2004, 2004.</li><li class="footnote" id="footnote-9"><a class="tag is-link" href="#citeref-9">9</a>Alvarez, E. J., and Ning, A., âHigh-Fidelity Modeling of Multirotor Aerodynamic Interactions for Aircraft Design,â AIAA Journal, Vol. 58, No. 10, 2020, pp. 4385â4400.</li><li class="footnote" id="footnote-a"><a class="tag is-link" href="#citeref-a">a</a>Let <span>$\phi$</span> be a field and <span>$\zeta_\sigma$</span> a filter kernel with cutoff length <span>$\sigma$</span>, the filter operator is defined as <span>$\overline{\phi} \left( \mathbf{x} \right) \equiv \int\limits_{-\infty}^\infty \phi(\mathbf{y})\zeta_\sigma(\mathbf{x}-\mathbf{y}) \,\mathrm{d}\mathbf{y}$</span>.</li></ul></section></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../visualization/">Â« Visualization</a><a class="docs-footer-nextpage" href="../convergence/">Convergence Â»</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Monday 8 January 2024 07:58">Monday 8 January 2024</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
