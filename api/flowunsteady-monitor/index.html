<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>(4) Monitors Definitions · FLOWUnsteady</title><script async src="https://www.googletagmanager.com/gtag/js?id=G-B7CBF7WC7L"></script><script>  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-B7CBF7WC7L', {'page_path': location.pathname + location.search + location.hash});
</script><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="FLOWUnsteady logo"/></a><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Intro</a></li><li><a class="tocitem" href="../../installation/general/">Installation</a></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">Tutorials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-4-1" type="checkbox"/><label class="tocitem" for="menuitem-4-1"><span class="docs-label">Simple Wing</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../examples/wing-4p2aoa/">Basics</a></li><li><a class="tocitem" href="../../examples/wing-aoasweep/">AOA Sweep</a></li></ul></li><li><a class="tocitem" href="../../examples/tetheredwing/">Tethered Wing</a></li><li><a class="tocitem" href="../../examples/heavingwing/">Heaving Wing</a></li><li><input class="collapse-toggle" id="menuitem-4-4" type="checkbox"/><label class="tocitem" for="menuitem-4-4"><span class="docs-label">Propeller</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../examples/propeller-J040/">Basics</a></li><li><a class="tocitem" href="../../examples/propeller-jsweep/"><span>$J$</span> Sweep</a></li><li><a class="tocitem" href="../../examples/propeller-quasisteady/">Quasi-Steady Solver</a></li><li><a class="tocitem" href="../../examples/propeller-incidence/">Incidence Sweep</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-5" type="checkbox"/><label class="tocitem" for="menuitem-4-5"><span class="docs-label">Rotor in Hover</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../examples/rotorhover-aero/">Variable Fidelity</a></li><li><a class="tocitem" href="../../examples/rotorhover-fdom/">Fluid Domain</a></li><li><a class="tocitem" href="../../examples/rotorhover-acoustics/">Aeroacoustics</a></li><li><a class="tocitem" href="../../examples/rotorhover-quasisteady/">Quasi-Steady Solver</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-6" type="checkbox"/><label class="tocitem" for="menuitem-4-6"><span class="docs-label">Blown Wing</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../examples/blownwing-aero/">Wing-on-Prop Interactions</a></li><li><a class="tocitem" href="../../examples/blownwing-asm/">Actuator Surface Model</a></li><li><a class="tocitem" href="../../examples/prowim-aero/">Prop-on-Wing Interactions</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-7" type="checkbox"/><label class="tocitem" for="menuitem-4-7"><span class="docs-label">eVTOL Aircraft</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../examples/vahana-vehicle/">Vehicle Definition</a></li><li><a class="tocitem" href="../../examples/vahana-maneuver/">Maneuver Definition</a></li><li><a class="tocitem" href="../../examples/vahana-monitor/">Monitors Definitions</a></li><li><a class="tocitem" href="../../examples/vahana-run/">Run Simulation</a></li></ul></li><li><a class="tocitem" href="../../examples/openvsp-aircraft/">OpenVSP Geometry</a></li></ul></li><li><a class="tocitem" href="../../visualization/">Visualization</a></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox"/><label class="tocitem" for="menuitem-6"><span class="docs-label">Theory</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../theory/rvpm/">Reformulated VPM</a></li><li><a class="tocitem" href="../../theory/convergence/">Convergence</a></li><li><a class="tocitem" href="../../theory/validation/">Validation</a></li><li><a class="tocitem" href="../../theory/publications/">Publications</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-7" type="checkbox" checked/><label class="tocitem" for="menuitem-7"><span class="docs-label">API Guide</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-7-1" type="checkbox"/><label class="tocitem" for="menuitem-7-1"><span class="docs-label">(1) Vehicle Definition</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../flowunsteady-vehicle-types/">Vehicle types</a></li><li><a class="tocitem" href="../flowunsteady-vehicle-components/">Generating components</a></li><li><a class="tocitem" href="../flowunsteady-vehicle-asm/">Actuator surface model</a></li><li><a class="tocitem" href="../flowunsteady-openvsp/">OpenVSP geometry</a></li></ul></li><li><a class="tocitem" href="../flowunsteady-maneuver/">(2) Maneuver Definition</a></li><li><a class="tocitem" href="../flowunsteady-simulation/">(3) Simulation Definition</a></li><li class="is-active"><a class="tocitem" href>(4) Monitors Definitions</a><ul class="internal"><li><a class="tocitem" href="#Monitor-Generators"><span>Monitor Generators</span></a></li><li><a class="tocitem" href="#Force-Calculators"><span>Force Calculators</span></a></li><li><a class="tocitem" href="#waketreatmentapi"><span>Wake Treatment</span></a></li></ul></li><li><a class="tocitem" href="../flowunsteady-run/">(5) Run Simulation</a></li><li><input class="collapse-toggle" id="menuitem-7-6" type="checkbox"/><label class="tocitem" for="menuitem-7-6"><span class="docs-label">(6) Viz and Postprocessing</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../flowunsteady-postprocessing-fdom/">Fluid Domain</a></li><li><a class="tocitem" href="../flowunsteady-postprocessing-noise/">Aeroacoustic Noise</a></li><li><a class="tocitem" href="../flowunsteady-postprocessing-misc/">Miscellaneous</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-7-7" type="checkbox"/><label class="tocitem" for="menuitem-7-7"><span class="docs-label">Extras</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-7-7-1" type="checkbox"/><label class="tocitem" for="menuitem-7-7-1"><span class="docs-label">FLOWVPM</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../flowvpm-particle/">Particle Field</a></li><li><a class="tocitem" href="../flowvpm-uj/">UJ Scheme</a></li><li><a class="tocitem" href="../flowvpm-viscous/">Viscous Scheme</a></li><li><a class="tocitem" href="../flowvpm-relaxation/">Relaxation Scheme</a></li><li><a class="tocitem" href="../flowvpm-sfs/">SFS Scheme</a></li><li><a class="tocitem" href="../flowvpm-time/">Time Integration</a></li><li><a class="tocitem" href="../flowvpm-utils/">Utilities</a></li></ul></li></ul></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">API Guide</a></li><li class="is-active"><a href>(4) Monitors Definitions</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>(4) Monitors Definitions</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/byuflowlab/FLOWUnsteady/blob/master/docs/src/api/flowunsteady-monitor.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="(4)-Monitors-Definitions"><a class="docs-heading-anchor" href="#(4)-Monitors-Definitions">(4) Monitors Definitions</a><a id="(4)-Monitors-Definitions-1"></a><a class="docs-heading-anchor-permalink" href="#(4)-Monitors-Definitions" title="Permalink"></a></h1><p>A monitor is a function that is passed to <a href="../flowunsteady-run/#FLOWUnsteady.run_simulation"><code>FLOWUnsteady.run_simulation</code></a> as an extra runtime function that is called at every time step. Runtime functions are expected to return a Boolean that indicates the need of stopping the simulation, such that if <code>extra_runtime_function</code> ever returns <code>true</code>, the simulation will immediately be ended.</p><p>Multiple monitors can be concatenated with boolean logic as follows</p><pre><code class="language-julia hljs">import FLOWUnsteady as uns

monitor_states = uns.generate_monitor_statevariables()
monitor_enstrophy = uns.generate_monitor_enstrophy()

monitors(args...; optargs...) = monitor_states(args...; optargs...) || monitor_enstrophy(args...; optargs...)</code></pre><p>Then pass the monitor to the simulation as</p><pre><code class="language-julia hljs">uns.run_simulation(sim, nsteps; extra_runtime_function=monitors, ...)</code></pre><div class="admonition is-compat"><header class="admonition-header">Monitor concatenation</header><div class="admonition-body"><p>FLOWUnsteady facilitates the concatenation of monitors through the function <a href="#FLOWUnsteady.concatenate"><code>FLOWUnsteady.concatenate</code></a>. Using this function, the example above looks like this:</p><pre><code class="language-julia hljs">monitor_states = uns.generate_monitor_statevariables()
monitor_enstrophy = uns.generate_monitor_enstrophy()

allmonitors = [monitor_states, monitor_enstrophy]

monitors = uns.concatenate(monitors)

uns.run_simulation(sim, nsteps; extra_runtime_function=monitors, ...)</code></pre></div></div><h2 id="Monitor-Generators"><a class="docs-heading-anchor" href="#Monitor-Generators">Monitor Generators</a><a id="Monitor-Generators-1"></a><a class="docs-heading-anchor-permalink" href="#Monitor-Generators" title="Permalink"></a></h2><p>The following are functions for generating the monitors that serve most use cases. See the source code of these monitors to get an idea of how to write your own user-defined monitors.</p><article class="docstring"><header><a class="docstring-binding" id="FLOWUnsteady.generate_monitor_statevariables" href="#FLOWUnsteady.generate_monitor_statevariables"><code>FLOWUnsteady.generate_monitor_statevariables</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">generate_monitor_statevariables(; save_path=nothing)</code></pre><p>Generate a monitor plotting the state variables of the vehicle at every time step. The state variables are vehicle velocity, vehicle angular velocity, and vehicle position.</p><p>Use <code>save_path</code> to indicate a directory where to save the plots.</p><p>Here is an example of this monitor on a vehicle flying a circular path: <img src="http://edoalvar2.groups.et.byu.net/public/FLOWUnsteady/tetheredwing-example-statemonitor.png" alt="image"/></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FLOWUnsteady/blob/1f0358519316310342ea95f0a861a000bc33c7ed/src/FLOWUnsteady_monitors.jl#L723-L734">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="FLOWUnsteady.generate_monitor_wing" href="#FLOWUnsteady.generate_monitor_wing"><code>FLOWUnsteady.generate_monitor_wing</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">generate_monitor_wing(wing::Union{vlm.Wing, vlm.WingSystem},
                        Vinf::Function, b_ref::Real, ar_ref::Real,
                        rho_ref::Real, qinf_ref::Real, nsteps_sim::Int;
                        L_dir=[0,0,1],      # Direction of lift component
                        D_dir=[1,0,0],      # Direction of drag component
                        calc_aerodynamicforce_fun=FLOWUnsteady.generate_calc_aerodynamicforce())</code></pre><p>Generate a wing monitor computing and plotting the aerodynamic force and wing loading at every time step.</p><p>The aerodynamic force is integrated, decomposed, and reported as overall lift coefficient <span>$C_L = \frac{L}{\frac{1}{2}\rho u_\infty^2 b c}$</span> and drag coefficient <span>${C_D = \frac{D}{\frac{1}{2}\rho u_\infty^2 b c}}$</span>. The wing loading is reported as the sectional lift and drag coefficients defined as <span>$c_\ell = \frac{\ell}{\frac{1}{2}\rho u_\infty^2 c}$</span> and <span>$c_d = \frac{d}{\frac{1}{2}\rho u_\infty^2 c}$</span>, respectively.</p><p>The aerodynamic force is calculated through the function <code>calc_aerodynamicforce_fun</code>, which is a user-defined function. The function can also be automatically generated through, <a href="#FLOWUnsteady.generate_calc_aerodynamicforce"><code>generate_calc_aerodynamicforce</code></a> which defaults to incluiding the Kutta-Joukowski force, parasitic drag (calculated from a NACA 0012 airfoil polar), and unsteady-circulation force.</p><ul><li><code>b_ref</code>       : Reference span length.</li><li><code>ar_ref</code>      : Reference aspect ratio, used to calculate the equivalent chord <span>$c = \frac{b}{\mathrm{ar}}$</span>.</li><li><code>rho_ref</code>     : Reference density.</li><li><code>qinf_ref</code>    : Reference dynamic pressure <span>$q_\infty = \frac{1}{2}\rho u_\infty^2$</span>.</li><li><code>nsteps_sim</code>  : the number of time steps by the end of the simulation (used for generating the color gradient).</li><li>Use <code>save_path</code> to indicate a directory where to save the plots. If so, it will also generate a CSV file with <span>$C_L$</span> and <span>$C_D$</span>.</li></ul><p>Here is an example of this monitor: <img src="http://edoalvar2.groups.et.byu.net/public/FLOWUnsteady/wing-example_convergence.png" alt="image"/></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FLOWUnsteady/blob/1f0358519316310342ea95f0a861a000bc33c7ed/src/FLOWUnsteady_monitors.jl#L225-L259">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="FLOWUnsteady.generate_monitor_rotors" href="#FLOWUnsteady.generate_monitor_rotors"><code>FLOWUnsteady.generate_monitor_rotors</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">generate_monitor_rotors(rotors::Array{vlm.Rotor}, J_ref::Real,
                            rho_ref::Real, RPM_ref::Real, nsteps_sim::Int;
                            save_path=nothing)</code></pre><p>Generate a rotor monitor plotting the aerodynamic performance and blade loading at every time step.</p><p>The aerodynamic performance consists of thrust coefficient <span>$C_T=\frac{T}{\rho n^2 d^4}$</span>, torque coefficient <span>$C_Q = \frac{Q}{\rho n^2 d^5}$</span>, and propulsive efficiency <span>$\eta = \frac{T u_\infty}{2\pi n Q}$</span>.</p><ul><li><code>J_ref</code> and <code>rho_ref</code> are the reference advance ratio and air density used for calculating propulsive efficiency and coefficients. The advance ratio used here is defined as <span>$J=\frac{u_\infty}{n d}$</span> with <span>$n = \frac{\mathrm{RPM}}{60}$</span>.</li><li><code>RPM_ref</code> is the reference RPM used to estimate the age of the wake.</li><li><code>nsteps_sim</code> is the number of time steps by the end of the simulation (used for generating the color gradient).</li><li>Use <code>save_path</code> to indicate a directory where to save the plots. If so, it will also generate a CSV file with <span>$C_T$</span>, <span>$C_Q$</span>, and <span>$\eta$</span>.</li></ul><p><img src="http://edoalvar2.groups.et.byu.net/public/FLOWUnsteady/rotorhover-example-high02-singlerotor_convergence.png" alt="image"/></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FLOWUnsteady/blob/1f0358519316310342ea95f0a861a000bc33c7ed/src/FLOWUnsteady_monitors.jl#L14-L34">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="FLOWUnsteady.generate_monitor_enstrophy" href="#FLOWUnsteady.generate_monitor_enstrophy"><code>FLOWUnsteady.generate_monitor_enstrophy</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">generate_monitor_enstrophy(; save_path=nothing)</code></pre><p>Generate a monitor plotting the global enstrophy of the flow at every time step (computed through the particle field). This is calculated by integrating the local enstrophy defined as ξ = ω⋅ω / 2.</p><p>Enstrophy is approximated as 0.5*Σ( Γ𝑝⋅ω(x𝑝) ). This is consistent with Winckelamns&#39; 1995 CTR report, &quot;Some Progress in LES using the 3-D VPM&quot;.</p><p>Use <code>save_path</code> to indicate a directory where to save the plots. If so, it will also generate a CSV file with ξ.</p><p>Here is an example of this monitor: <img src="http://edoalvar2.groups.et.byu.net/public/FLOWUnsteady/rotorhover-example-high02-singlerotorenstrophy.png" alt="image"/></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FLOWUnsteady/blob/1f0358519316310342ea95f0a861a000bc33c7ed/src/FLOWUnsteady_monitors.jl#L799-L814">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="FLOWUnsteady.generate_monitor_Cd" href="#FLOWUnsteady.generate_monitor_Cd"><code>FLOWUnsteady.generate_monitor_Cd</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">generate_monitor_Cd(; save_path=nothing)</code></pre><p>Generate a monitor plotting the mean value of the SFS model coefficient <span>$C_d$</span> across the particle field at every time step. It also plots the ratio of <span>$C_d$</span> values that were clipped to zero (not included in the mean).</p><p>Use <code>save_path</code> to indicate a directory where to save the plots. If so, it will also generate a CSV file with the statistics of <span>$C_d$</span> (particles whose coefficients have been clipped are ignored).</p><p>Here is an example of this monitor: <img src="http://edoalvar2.groups.et.byu.net/public/FLOWUnsteady/rotorhover-example-high02-singlerotorChistory.png" alt="image"/></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FLOWUnsteady/blob/1f0358519316310342ea95f0a861a000bc33c7ed/src/FLOWUnsteady_monitors.jl#L873-L886">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="FLOWUnsteady.concatenate" href="#FLOWUnsteady.concatenate"><code>FLOWUnsteady.concatenate</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">concatenate(monitors::Array{Function})
concatenate(monitors::NTuple{N, Function})
concatenate(monitor1, monitor2, ...)</code></pre><p>Concatenates a collection of monitors into a pipeline, returning one monitor of the form</p><pre><code class="language-julia hljs">monitor(args...; optargs...) =
    monitors[1](args...; optargs...) || monitors[2](args...; optargs...) || ...</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FLOWUnsteady/blob/1f0358519316310342ea95f0a861a000bc33c7ed/src/FLOWUnsteady_monitors.jl#L976-L987">source</a></section></article><h2 id="Force-Calculators"><a class="docs-heading-anchor" href="#Force-Calculators">Force Calculators</a><a id="Force-Calculators-1"></a><a class="docs-heading-anchor-permalink" href="#Force-Calculators" title="Permalink"></a></h2><p>The following are some possible methods for calculating aerodynamic forces. Generator functions return a function that can be directly passed to <a href="#FLOWUnsteady.generate_monitor_wing"><code>FLOWUnsteady.generate_monitor_wing</code></a> through the keyword argument <code>calc_aerodynamicforce_fun</code>.</p><article class="docstring"><header><a class="docstring-binding" id="FLOWUnsteady.generate_calc_aerodynamicforce" href="#FLOWUnsteady.generate_calc_aerodynamicforce"><code>FLOWUnsteady.generate_calc_aerodynamicforce</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">generate_calc_aerodynamicforce(; add_parasiticdrag=false,
                                      add_skinfriction=true,
                                      airfoilpolar=&quot;xf-n0012-il-500000-n5.csv&quot;,
                                      parasiticdrag_args=(),
                                      )</code></pre><p>Default method for calculating aerodynamic forces.</p><p>Pass the output of this function to <a href="#FLOWUnsteady.generate_monitor_wing"><code>generate_monitor_wing</code></a>, or use this as an example on how to define your own costumized force calculations.</p><p>This function stitches together the outputs of <a href="#FLOWUnsteady.generate_aerodynamicforce_kuttajoukowski"><code>generate_aerodynamicforce_kuttajoukowski</code></a> and <a href="#FLOWUnsteady.generate_aerodynamicforce_parasiticdrag"><code>generate_aerodynamicforce_parasiticdrag</code></a>, and <a href="#FLOWUnsteady.calc_aerodynamicforce_unsteady"><code>calc_aerodynamicforce_unsteady</code></a>. See <a href="https://scholarsarchive.byu.edu/etd/9589/">Alvarez&#39; dissertation</a>, Sec. 6.3.3.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FLOWUnsteady/blob/1f0358519316310342ea95f0a861a000bc33c7ed/src/FLOWUnsteady_processing_force.jl#L10-L28">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="FLOWUnsteady.generate_aerodynamicforce_kuttajoukowski" href="#FLOWUnsteady.generate_aerodynamicforce_kuttajoukowski"><code>FLOWUnsteady.generate_aerodynamicforce_kuttajoukowski</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">generate_aerodynamicforce_kuttajoukowski(KJforce_type::String,
                            sigma_vlm_surf, sigma_rotor_surf,
                            vlm_vortexsheet,
                            vlm_vortexsheet_overlap,
                            vlm_vortexsheet_distribution,
                            vlm_vortexsheet_sigma_tbv;
                            vehicle=nothing
                            )</code></pre><p>Calculates the aerodynamic force at each element of a VLM system using its current <code>Gamma</code> solution and the Kutta-Joukowski theorem. It saves the force as the field <code>vlm_system.sol[&quot;Ftot&quot;]</code></p><p>This force calculated through the Kutta-Joukowski theorem uses the freestream velocity, kinematic velocity, and wake-induced velocity on each bound vortex. See <a href="https://scholarsarchive.byu.edu/etd/9589/">Alvarez&#39; dissertation</a>, Sec. 6.3.3.</p><p><strong>ARGUMENTS</strong></p><ul><li><code>vlm_vortexsheet::Bool</code>   : If true, the bound vorticity is approximated with                               and actuator surface model through a vortex                               sheet. If false, it is approximated with an                               actuator line model with horseshoe vortex                               filaments.</li><li><code>vlm_vortexsheet_overlap::Bool</code>       : Target core overlap between particles                               representing the vortex sheet (if                               <code>vlm_vortexsheet=true</code>).</li><li><code>vlm_vortexsheet_distribution::Function</code> : Vorticity distribution in vortex                               sheet (see <code>g_uniform</code>, <code>g_linear</code>, and                               <code>g_pressure</code>).</li><li><code>KJforce_type::String</code>    : If <code>vlm_vortexsheet=true</code>, it specifies how to                               weight the force of each particle in the vortex                               sheet. If <code>KJforce_type==&quot;averaged&quot;</code>, the KJ                               force is a chordwise average of the force                               experienced by the particles. If                               <code>KJforce_type==&quot;weighted&quot;</code>, the KJ force                               is chordwise weighted by the strength of each                               particle. If <code>KJforce_type==&quot;regular&quot;</code>, the                               vortex sheet is ignored, and the KJ force                               is calculated from the velocity induced                               at midpoint between the horseshoe filaments.</li><li><code>vehicle::VLMVehicle</code>     : If <code>vlm_vortexsheet=true</code>, it is expected that the                               vehicle object is passed through this argument.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FLOWUnsteady/blob/1f0358519316310342ea95f0a861a000bc33c7ed/src/FLOWUnsteady_processing_force.jl#L84-L128">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="FLOWUnsteady.generate_aerodynamicforce_parasiticdrag" href="#FLOWUnsteady.generate_aerodynamicforce_parasiticdrag"><code>FLOWUnsteady.generate_aerodynamicforce_parasiticdrag</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">generate_aerodynamicforce_parasiticdrag(polar_file::String;
                                                read_path=FLOWUnsteady.default_database*&quot;/airfoils&quot;,
                                                calc_cd_from_cl=false,
                                                add_skinfriction=true,
                                                Mach=nothing)</code></pre><p>Calculates the parasitic drag along the wing using a lookup airfoil table. It adds this force to the field <code>vlm_system.sol[&quot;Ftot&quot;]</code>.</p><p>The lookup table is read from the file <code>polar_file</code> under the directory <code>read_path</code>. The parasitic drag includes form drag, skin friction, and wave drag, assuming that each of these components are included in the lookup polar. <code>polar_file</code> can be any polar file downloaded from <a href="http://airfoiltools.com/">airfoiltools.com</a>.</p><p>To ignore skin friction drag, use <code>add_skinfriction=false</code>.</p><p>The drag will be calculated from the local effective angle of attack, unless <code>calc_cd_from_cl=true</code> is used, which then will be calculated from the local lift coefficient given by the circulation distribution. cd from cl tends to be more accurate than from AOA, but the method might fail to correlate cd and cl depending on how noise the polar data is.</p><p>If <code>Mach != nothing</code>, it will use a Prandtl-Glauert correction to pre-correct the lookup cl. This will have no effects if <code>calc_cd_from_cl=false</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FLOWUnsteady/blob/1f0358519316310342ea95f0a861a000bc33c7ed/src/FLOWUnsteady_processing_force.jl#L472-L498">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="FLOWUnsteady.calc_aerodynamicforce_unsteady" href="#FLOWUnsteady.calc_aerodynamicforce_unsteady"><code>FLOWUnsteady.calc_aerodynamicforce_unsteady</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">calc_aerodynamicforce_unsteady(vlm_system::Union{vlm.Wing, vlm.WingSystem},
                            prev_vlm_system, pfield, Vinf, dt, rho; t=0.0,
                            per_unit_span=false, spandir=[0, 1, 0],
                            include_trailingboundvortex=false,
                            add_to_Ftot=false
                            )</code></pre><p>Force from unsteady circulation.</p><p>This force tends to add a lot of numerical noise, which in most cases ends up cancelling out when the loading is time-averaged. Hence, <code>add_to_Ftot=false</code> will calculate the unsteady loading and save it under the field <code>Funs-vector</code>, but it will not be added to the Ftot vector that is used to calculate the wing&#39;s overall aerodynamic force.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FLOWUnsteady/blob/1f0358519316310342ea95f0a861a000bc33c7ed/src/FLOWUnsteady_processing_force.jl#L363-L378">source</a></section></article><h2 id="waketreatmentapi"><a class="docs-heading-anchor" href="#waketreatmentapi">Wake Treatment</a><a id="waketreatmentapi-1"></a><a class="docs-heading-anchor-permalink" href="#waketreatmentapi" title="Permalink"></a></h2><p>Since the full set of state variables is passed to <code>extra_runtime_function</code>, this function can also be used to alter the simulation on the fly. In some circumstances it is desirable to be able to remove or modify particles, which process we call &quot;wake treatment.&quot; Wake treatment is often used to reduce computational cost (for instance, by removing particle in regions of the flow that are not of interest), and it can also be used to force numerical stability (for instance, by removing or clipping particles with vortex strengths that grow beyond certain threshold).</p><p>These wake treatment methods can be added into the pipeline of <code>extra_runtime_function</code> as follows:</p><pre><code class="language-julia hljs">import FLOWUnsteady as uns

# Define monitors
monitor_states = uns.generate_monitor_statevariables()
monitor_enstrophy = uns.generate_monitor_enstrophy()

# Monitor pipeline
monitors = uns.concatenate(monitor_states, monitor_enstrophy)

# Define wake treatment
wake_treatment = uns.remove_particles_sphere(1.0, 1; Xoff=zeros(3))

# Extra runtime function pipeline
extra_runtime_function = uns.concatenate(monitors, wake_treatment)
</code></pre><p>Then pass this pipeline to the simulation as</p><pre><code class="language-julia hljs">uns.run_simulation(sim, nsteps; extra_runtime_function=extra_runtime_function, ...)</code></pre><p>Below we list a few generator functions that return common wake treatment methods.</p><article class="docstring"><header><a class="docstring-binding" id="FLOWUnsteady.remove_particles_sphere" href="#FLOWUnsteady.remove_particles_sphere"><code>FLOWUnsteady.remove_particles_sphere</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">remove_particles_sphere(Rsphere2, step::Int; Xoff::Vector=zeros(3))</code></pre><p>Returns an <code>extra_runtime_function</code> that every <code>step</code> steps removes all particles that are outside of a sphere of radius <code>sqrt(Rsphere2)</code> centered around the vehicle or with an offset <code>Xoff</code> from the center of the vehicle.</p><p>Use this wake treatment to avoid unnecesary computation by removing particles that have gone beyond the region of interest.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FLOWUnsteady/blob/1f0358519316310342ea95f0a861a000bc33c7ed/src/FLOWUnsteady_processing.jl#L151-L160">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="FLOWUnsteady.remove_particles_box" href="#FLOWUnsteady.remove_particles_box"><code>FLOWUnsteady.remove_particles_box</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">remove_particles_box(Pmin::Vector, Pmax::Vector, step::Int)</code></pre><p>Returns an <code>extra_runtime_function</code> that every <code>step</code> steps removes all particles that are outside of a box of minimum and maximum vertices <code>Pmin</code> and <code>Pmax</code>.</p><p>Use this wake treatment to avoid unnecesary computation by removing particles that have gone beyond the region of interest.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FLOWUnsteady/blob/1f0358519316310342ea95f0a861a000bc33c7ed/src/FLOWUnsteady_processing.jl#L114-L123">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="FLOWUnsteady.remove_particles_lowstrength" href="#FLOWUnsteady.remove_particles_lowstrength"><code>FLOWUnsteady.remove_particles_lowstrength</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">remove_particles_lowstrength(critGamma2, step)</code></pre><p>Returns an <code>extra_runtime_function</code> that removes all particles with a vortex strength magnitude that is smaller than <code>sqrt(critGamma2)</code>. Use this wake treatment to avoid unnecesary computation by removing particles that have negligibly-low strength.</p><p><code>step</code> indicates every how many steps to remove particles.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FLOWUnsteady/blob/1f0358519316310342ea95f0a861a000bc33c7ed/src/FLOWUnsteady_processing.jl#L71-L80">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="FLOWUnsteady.remove_particles_strength" href="#FLOWUnsteady.remove_particles_strength"><code>FLOWUnsteady.remove_particles_strength</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">remove_particles_strength(minGamma2, maxGamma2; every_nsteps=1)</code></pre><p>Returns an <code>extra_runtime_function</code> that removes all particles with a vortex strength magnitude that is larger than <code>sqrt(maxGamma2)</code> or smaller than <code>sqrt(minGamma2)</code>. Use <code>every_nsteps</code> to indicate every how many steps to remove particles.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FLOWUnsteady/blob/1f0358519316310342ea95f0a861a000bc33c7ed/src/FLOWUnsteady_processing.jl#L41-L48">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="FLOWUnsteady.remove_particles_sigma" href="#FLOWUnsteady.remove_particles_sigma"><code>FLOWUnsteady.remove_particles_sigma</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">remove_particles_sigma(minsigma, maxsigma; every_nsteps=1)</code></pre><p>Returns an <code>extra_runtime_function</code> that removes all particles with a smoothing radius that is larger than <code>maxsigma</code> or smaller than <code>minsigma</code>. Use <code>every_nsteps</code> to indicate every how many steps to remove particles.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FLOWUnsteady/blob/1f0358519316310342ea95f0a861a000bc33c7ed/src/FLOWUnsteady_processing.jl#L85-L91">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../flowunsteady-simulation/">« (3) Simulation Definition</a><a class="docs-footer-nextpage" href="../flowunsteady-run/">(5) Run Simulation »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Tuesday 16 April 2024 17:39">Tuesday 16 April 2024</span>. Using Julia version 1.10.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
