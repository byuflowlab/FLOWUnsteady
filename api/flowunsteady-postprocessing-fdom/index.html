<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Fluid Domain · FLOWUnsteady</title><script async src="https://www.googletagmanager.com/gtag/js?id=G-B7CBF7WC7L"></script><script>  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-B7CBF7WC7L', {'page_path': location.pathname + location.search + location.hash});
</script><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="FLOWUnsteady logo"/></a><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Intro</a></li><li><a class="tocitem" href="../../installation/general/">Installation</a></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">Tutorials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-4-1" type="checkbox"/><label class="tocitem" for="menuitem-4-1"><span class="docs-label">Simple Wing</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../examples/wing-4p2aoa/">Basics</a></li><li><a class="tocitem" href="../../examples/wing-aoasweep/">AOA Sweep</a></li></ul></li><li><a class="tocitem" href="../../examples/tetheredwing/">Tethered Wing</a></li><li><a class="tocitem" href="../../examples/heavingwing/">Heaving Wing</a></li><li><input class="collapse-toggle" id="menuitem-4-4" type="checkbox"/><label class="tocitem" for="menuitem-4-4"><span class="docs-label">Propeller</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../examples/propeller-J040/">Basics</a></li><li><a class="tocitem" href="../../examples/propeller-jsweep/"><span>$J$</span> Sweep</a></li><li><a class="tocitem" href="../../examples/propeller-quasisteady/">Quasi-Steady Solver</a></li><li><a class="tocitem" href="../../examples/propeller-incidence/">Incidence Sweep</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-5" type="checkbox"/><label class="tocitem" for="menuitem-4-5"><span class="docs-label">Rotor in Hover</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../examples/rotorhover-aero/">Variable Fidelity</a></li><li><a class="tocitem" href="../../examples/rotorhover-fdom/">Fluid Domain</a></li><li><a class="tocitem" href="../../examples/rotorhover-acoustics/">Aeroacoustics</a></li><li><a class="tocitem" href="../../examples/rotorhover-quasisteady/">Quasi-Steady Solver</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-6" type="checkbox"/><label class="tocitem" for="menuitem-4-6"><span class="docs-label">Blown Wing</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../examples/blownwing-aero/">Wing-on-Rotor Interactions</a></li><li><a class="tocitem" href="../../examples/blownwing-asm/">Actuator Surface Model</a></li><li><a class="tocitem" href="../../examples/prowim-aero/">Rotor-on-Wing Interactions</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-7" type="checkbox"/><label class="tocitem" for="menuitem-4-7"><span class="docs-label">eVTOL Aircraft</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../examples/vahana-vehicle/">Vehicle Definition</a></li><li><a class="tocitem" href="../../examples/vahana-maneuver/">Maneuver Definition</a></li><li><a class="tocitem" href="../../examples/vahana-monitor/">Monitors Definitions</a></li><li><a class="tocitem" href="../../examples/vahana-run/">Run Simulation</a></li></ul></li><li><a class="tocitem" href="../../examples/openvsp-aircraft/">OpenVSP Geometry</a></li></ul></li><li><a class="tocitem" href="../../visualization/">Visualization</a></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox"/><label class="tocitem" for="menuitem-6"><span class="docs-label">Theory</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../theory/rvpm/">Reformulated VPM</a></li><li><a class="tocitem" href="../../theory/convergence/">Convergence</a></li><li><a class="tocitem" href="../../theory/validation/">Validation</a></li><li><a class="tocitem" href="../../theory/publications/">Publications</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-7" type="checkbox" checked/><label class="tocitem" for="menuitem-7"><span class="docs-label">API Guide</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-7-1" type="checkbox"/><label class="tocitem" for="menuitem-7-1"><span class="docs-label">(1) Vehicle Definition</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../flowunsteady-vehicle-types/">Vehicle types</a></li><li><a class="tocitem" href="../flowunsteady-vehicle-components/">Generating components</a></li><li><a class="tocitem" href="../flowunsteady-vehicle-asm/">Actuator surface model</a></li><li><a class="tocitem" href="../flowunsteady-openvsp/">OpenVSP geometry</a></li></ul></li><li><a class="tocitem" href="../flowunsteady-maneuver/">(2) Maneuver Definition</a></li><li><a class="tocitem" href="../flowunsteady-simulation/">(3) Simulation Definition</a></li><li><a class="tocitem" href="../flowunsteady-monitor/">(4) Monitors Definitions</a></li><li><a class="tocitem" href="../flowunsteady-run/">(5) Run Simulation</a></li><li><input class="collapse-toggle" id="menuitem-7-6" type="checkbox" checked/><label class="tocitem" for="menuitem-7-6"><span class="docs-label">(6) Viz and Postprocessing</span><i class="docs-chevron"></i></label><ul class="collapsed"><li class="is-active"><a class="tocitem" href>Fluid Domain</a></li><li><a class="tocitem" href="../flowunsteady-postprocessing-noise/">Aeroacoustic Noise</a></li><li><a class="tocitem" href="../flowunsteady-postprocessing-misc/">Miscellaneous</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-7-7" type="checkbox"/><label class="tocitem" for="menuitem-7-7"><span class="docs-label">Extras</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-7-7-1" type="checkbox"/><label class="tocitem" for="menuitem-7-7-1"><span class="docs-label">FLOWVPM</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../flowvpm-particle/">Particle Field</a></li><li><a class="tocitem" href="../flowvpm-uj/">UJ Scheme</a></li><li><a class="tocitem" href="../flowvpm-viscous/">Viscous Scheme</a></li><li><a class="tocitem" href="../flowvpm-relaxation/">Relaxation Scheme</a></li><li><a class="tocitem" href="../flowvpm-sfs/">SFS Scheme</a></li><li><a class="tocitem" href="../flowvpm-time/">Time Integration</a></li><li><a class="tocitem" href="../flowvpm-utils/">Utilities</a></li></ul></li></ul></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">API Guide</a></li><li><a class="is-disabled">(6) Viz and Postprocessing</a></li><li class="is-active"><a href>Fluid Domain</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Fluid Domain</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/byuflowlab/FLOWUnsteady/blob/master/docs/src/api/flowunsteady-postprocessing-fdom.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="fluid_domain"><a class="docs-heading-anchor" href="#fluid_domain">Fluid Domain</a><a id="fluid_domain-1"></a><a class="docs-heading-anchor-permalink" href="#fluid_domain" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-binding" id="FLOWUnsteady.computefluiddomain" href="#FLOWUnsteady.computefluiddomain"><code>FLOWUnsteady.computefluiddomain</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">computefluiddomain( pfield::FLOWVPM.ParticleField,
                    grids::Array{&lt;:GeometricTools.AbstractGrid};
                    optargs...
                    )</code></pre><p>Evaluate the velocity and vorticity field induced by the particle field <code>pfield</code> at all nodes in a set of grids <code>grids</code>. The fields are added as solution fields <code>U</code> and <code>W</code> in each grid. The analytic Jacobian of the velocity field can also be saved using the optional argument <code>add_J=true</code>.</p><p><strong>OPTIONAL ARGUMENTS</strong></p><p><strong>Processing options</strong></p><ul><li><code>add_J::Bool=false</code>       : Add the solution fields <code>J1</code>, <code>J2</code>, and <code>J3</code> to                               each grid, where Ji[j]=dUi/dxj.</li><li><code>add_Uinf::Bool=false</code>    : It evaluates and adds the uniform freestream to                               the <code>U</code> field.</li><li><code>add_Wapprox::Bool=false</code> : It evaluates and saves the RBF-approximated                               vorticity field under the field <code>Wapprox</code>.</li><li><code>zeta::Function=FLOWVPM.zeta_fmm</code> : Method for evaluating RBF-approximated vorticity                               (used only if <code>add_Wapprox==true</code>).</li><li><code>scale_sigma::Real=1.0</code>   : It rescales the smoothing radius of each particle                               by this factor before evaluating the particle                               field.</li></ul><p><strong>Output options</strong></p><ul><li><code>save_path::String</code>       : If used, it will save the grids as XDMF files                               under this path.</li><li><code>file_pref::String</code>       : Prefix for XDMF files.</li><li><code>grid_names::String</code>      : Name of each grid for XDMF files. If not given, it                               will generate their names automatically.</li><li><code>num::Int</code>                : If given, the name of the XDMF files will be                               <code>&quot;$(file_pref)$(grid_names[i]).$(num).vtk&quot;</code></li><li><code>verbose::Bool=true</code>      : Activate/deactivate verbose.</li><li><code>v_lvl::Int=0</code>            : Indentation level for printing verbose.</li></ul><p><strong>NOTE:</strong> The solution fields <code>U</code>, <code>W</code>, and Jacobian do not include the freestream         field, but rather they only include the fields induced by the particles.         To add the freestream to <code>U</code>, use the optional argument <code>add_Uinf=true</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FLOWVPM.jl//blob/d85451638c5879c694ee06c1eeecbf4bcd7c74c1/examples/utilities/utilities_fluiddomain.jl#L13-L55">source</a></section><section><div><pre><code class="nohighlight hljs">computefluiddomain(pfield::vpm.ParticleField,
                    nums::Vector{Int}, read_path::String, file_pref::String,
                    grids;
                    origin=nothing,
                    orientation=nothing,
                    other_read_paths=[],
                    other_file_prefs=[],
                    userfunction_pfield=(pfield, num, grids)-&gt;nothing,
                    optargs...
                    )</code></pre><p>Evaluate the fluid domain at each time step in <code>nums</code> that is induced by a particle field saved under <code>read_path</code>. <code>file_pref</code> indicates the prefix of the .h5 files to read.</p><p>To translate and re-orient the grids at each time step, the user can pass the new origin vector and orientation matrix through the functions <code>origin</code> and <code>orientation</code>, which will be called as <code>origin(pfield, num)</code> and <code>orientation(pfield, num)</code> at each time step.</p><p><code>pfield</code> is a place holder for loading the particles that are read, so the user must make sure that sufficient memory has been preallocated to hold the number of particles of each time step that will be read, plus the number of nodes in the grids. The fluid domain will be evaluated using the UJ and FMM configuration of the given <code>pfield</code> particle field.</p><p>To read and add more than one particle field at each time step, pass a list of paths and prefixes through <code>other_read_paths</code> and <code>other_file_prefs</code>. This is useful for reading and incluiding a set of static particles, for example.</p><p>Give it a function <code>userfunction_pfield</code> to pre-process the resulting particle field before evaluating the fluid domain (<em>e.g.</em>, remove particles, resize core sizes, etc).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FLOWVPM.jl//blob/d85451638c5879c694ee06c1eeecbf4bcd7c74c1/examples/utilities/utilities_fluiddomain.jl#L222-L256">source</a></section><section><div><pre><code class="nohighlight hljs">computefluiddomain(maxparticles::Int, args...;
                    UJ::Function=vpm.UJ_fmm,
                    fmm::FLOWVPM.FMM=vpm.FMM(; p=4, ncrit=50, theta=0.4, phi=0.5),
                    pfield_optargs=[]
                    optargs...)</code></pre><p>Like the other <code>computefluiddomain(args...; optargs...)</code> methods, but automatically pre-allocating and initializing the particle field with the given maximum number of particles, UJ evaluation method, and FMM configuration (if FMM is used by UJ).</p><p>Use <code>pfield_optargs</code> to pass any additional optional arguments to the particle field constructor.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FLOWVPM.jl//blob/d85451638c5879c694ee06c1eeecbf4bcd7c74c1/examples/utilities/utilities_fluiddomain.jl#L336-L350">source</a></section><section><div><pre><code class="nohighlight hljs">computefluiddomain(P_min, P_max, NDIVS, args...;
                    spacetransform=nothing,
                    O=zeros(3), Oaxis=Float64[i==j for i in 1:3, j in 1:3],
                    optargs...)`</code></pre><p>Like the other <code>computefluiddomain(args...; optargs...)</code> methods, but automatically generating a fluid domain grid. The grid is generated as a Cartesian box with minimum and maximum corners <code>P_min</code> and <code>P_max</code> and <code>NDIVS</code> cells.</p><p>For instance, <code>P_min=[-1, -1, -1]</code>, <code>P_max=[-1, -1, -1]</code>, and <code>NDIVS=[10, 10, 50]</code> will grid the volumetric space between -1 and 1 in all directions, with 10 cells in both the x and y-direction, and 50 cells in the z-direction.</p><p>Even though the grid is first generated as a Cartesian grid, this can be transformed into any other structured space through the argument <code>spacetransform</code>, which is a function that takes any vector and returns another vector of the same dimensions. For instance, <code>P_min=[0.5, 0, 0], P_max=[1, 2*pi, 5], NDIVS=[10, 20, 30], spacetransform=GeometricTools.cylindrical3D</code> will generate a cylindrical grid discretizing the radial annulus from 0.5 to 1 with 10 cells, the polar angle from 0 to 360deg with 20 cells, and the axial z-distance from 0 through 5 with 30 cells.</p><p>Any number of dimensions can be used, but make sure that <code>P_min</code>, <code>P_max</code>, and <code>NDIVS</code> always have three dimensions and indicate the dimensions that are &quot;collapsed&quot; with a 0 in <code>NDIVS</code>. Even though the grid is defined in the Cartesian axes, the origin and orientation of the grid can be specified with the <code>O</code> and <code>Oaxis</code> optional arguments. For instance, <code>P_min=[0, 0, 1], P_max=[2, 3.5, 1], NDIVS=[10, 10, 0]</code> will generate a 2D surface laying in the xy-plane at z=1.0, spanning from (x,y)=(0,0) to (x,y)=(2,3.5). Use <code>O=[0, 0, -1]</code> to move the surface back to the xy-plane at z=0. Use <code>Oaxis=[1 0 0; 0 0 -1; 0 1 0]</code> to re-orient the surface to lay in the zx-plane. The same thing can be achieved with <code>Oaxis=GeometricTools.rotation_matrix2(-90, 0, 0)</code> which generates the rotation matrix corresponding to a -90deg rotation about the x-axis.</p><p><strong>NOTE:</strong> The order of operation is (1) Cartesian grid generation, (2) space transformation if any, and (3) translation and re-orientation to the given origin and orientation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FLOWVPM.jl//blob/d85451638c5879c694ee06c1eeecbf4bcd7c74c1/examples/utilities/utilities_fluiddomain.jl#L371-L413">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="FLOWUnsteady.generate_preprocessing_fluiddomain_pfield" href="#FLOWUnsteady.generate_preprocessing_fluiddomain_pfield"><code>FLOWUnsteady.generate_preprocessing_fluiddomain_pfield</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">generate_preprocessing_fluiddomain_pfield(maxsigma, maxmagGamma;
                                                verbose=true, v_lvl=1)</code></pre><p>Generate function for pre-processing particle fields before generating fluid domain: shrink oversized particles and correct blown-up particles.</p><p>Pass the output function to <a href="#FLOWUnsteady.computefluiddomain"><code>FLOWUnsteady.computefluiddomain</code></a> through the keyword argument <code>userfunction_pfield</code>. For example:</p><pre><code class="language-julia hljs">preprocess_pfield = generate_preprocessing_fluiddomain_pfield(maxsigma, maxmagGamma;
                                                                verbose=true, v_lvl=1)

computefluiddomain( ... ; userfunction_pfield=preprocess_pfield, ...)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FLOWUnsteady/blob/b44dcd060b5d318b8fc56b60529794cae8ff6fab/src/FLOWUnsteady_postprocessing.jl#L171-L186">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../flowunsteady-run/">« (5) Run Simulation</a><a class="docs-footer-nextpage" href="../flowunsteady-postprocessing-noise/">Aeroacoustic Noise »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Monday 8 January 2024 07:37">Monday 8 January 2024</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
